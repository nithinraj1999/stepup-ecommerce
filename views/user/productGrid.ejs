<%-include('../layout/userHeader')-%>
<%-include('../layout/userNavbar')-%>

        <main class="main">
        	<div class="page-header text-center" style="background-image: url('assets/images/page-header-bg.jpg')">
        		<div class="container">
                    <h1 class="page-title"><%=category %><span>Shop</span></h1>
        		</div><!-- End .container -->
        	</div><!-- End .page-header -->
            <nav aria-label="breadcrumb" class="breadcrumb-nav mb-2">
                <div class="container">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a href="index.html">Home</a></li>
                        <li class="breadcrumb-item"><a href="#">Shop</a></li>
                        <li class="breadcrumb-item active" aria-current="page">Grid 3 Columns</li>
                    </ol>
                </div><!-- End .container -->
            </nav><!-- End .breadcrumb-nav -->

            <div class="page-content">
                <div class="container">
                	<div class="row">
                		<div class="col-lg-9">
                			<div class="toolbox">
                				<div class="toolbox-left">
                					<!-- <div class="toolbox-info">
                						Showing <span>9 of 56</span> Products
                					</div> -->
                                    <div>
                                        <input id="product-search" type="search">
                                        <button id="search-button" onclick="applyFilter()" type="submit">search</button>
                                    </div>
                                                
                				</div><!-- End .toolbox-left -->

                				<div class="toolbox-right">
                					<div class="toolbox-sort">
                						<label for="sortby">Sort by price:</label>
                						<div class="select-custom">
											<select name="sortby" id="sortby" class="form-control"  onchange=" applyFilter()">
                                                <option value="" disabled selected>Sort By</option>
												<option value=-1 > High To Low</option>
												<option value=1>Low To High </option>
												
											</select>
										</div>
                					</div><!-- End .toolbox-sort -->
                					<!-- <div class="toolbox-layout">
                						<a href="category-list.html" class="btn-layout">
                							<svg width="16" height="10">
                								<rect x="0" y="0" width="4" height="4" />
                								<rect x="6" y="0" width="10" height="4" />
                								<rect x="0" y="6" width="4" height="4" />
                								<rect x="6" y="6" width="10" height="4" />
                							</svg>
                						</a>

                						<a href="category-2cols.html" class="btn-layout">
                							<svg width="10" height="10">
                								<rect x="0" y="0" width="4" height="4" />
                								<rect x="6" y="0" width="4" height="4" />
                								<rect x="0" y="6" width="4" height="4" />
                								<rect x="6" y="6" width="4" height="4" />
                							</svg>
                						</a>

                						<a href="category.html" class="btn-layout active">
                							<svg width="16" height="10">
                								<rect x="0" y="0" width="4" height="4" />
                								<rect x="6" y="0" width="4" height="4" />
                								<rect x="12" y="0" width="4" height="4" />
                								<rect x="0" y="6" width="4" height="4" />
                								<rect x="6" y="6" width="4" height="4" />
                								<rect x="12" y="6" width="4" height="4" />
                							</svg>
                						</a>

                						<a href="category-4cols.html" class="btn-layout">
                							<svg width="22" height="10">
                								<rect x="0" y="0" width="4" height="4" />
                								<rect x="6" y="0" width="4" height="4" />
                								<rect x="12" y="0" width="4" height="4" />
                								<rect x="18" y="0" width="4" height="4" />
                								<rect x="0" y="6" width="4" height="4" />
                								<rect x="6" y="6" width="4" height="4" />
                								<rect x="12" y="6" width="4" height="4" />
                								<rect x="18" y="6" width="4" height="4" />
                							</svg>
                						</a>
                					</div> -->
                				</div><!-- End .toolbox-right -->
                			</div><!-- End .toolbox -->

                            <div class="products mb-3"   >
                                <div class="row justify-content-center" id="All-Products">
                                    <%find.forEach((i)=>{ %>
                                    <div class="col-6 col-md-4 col-lg-4">
                                        <div class="product product-7 text-center">
                                            <figure class="product-media">
                                                <!-- <span class="product-label label-new">New</span> -->
                                                <a href="product-details?id=<%=i._id %>">
                                                    <img src="/uploads/<%= i?.product_image[3]?.resizedFile %>" alt="Product image" class="product-image">
                                                </a>

                                                <div class="product-action-vertical">
                                                    <% const exist =  wishList?.product?.find(item => item?.productId?.equals(i?._id)) %>
                                                        <% if(exist){ %>
                                                            <a href="#" class="" style="margin-left: 350px;" onclick="addToWishList('<%= i?._id %>',event)">
                                                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="red" id="wish<%= i?._id %>" class="bi bi-heart-fill" viewBox="0 0 16 16">
                                                                     <path fill-rule="evenodd" d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314"/>
                                                                   </svg>
                                                             </a>
                                                        <% } else { %>
                                                            <a href="#" class="" style="margin-left: 350px;" onclick="addToWishList('<%= i?._id %>',event)">
                                                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="gray" id="wish<%= i?._id %>"  class="bi bi-heart-fill" viewBox="0 0 16 16">
                                                                     <path fill-rule="evenodd" d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314"/>
                                                                   </svg>
                                                             </a>
                                                        <% } %>
                                                    <!-- <a href="popup/quickView.html" class="btn-product-icon btn-quickview" title="Quick view"><span>Quick view</span></a>
                                                    <a href="#" class="btn-product-icon btn-compare" title="Compare"><span>Compare</span></a> -->
                                                </div><!-- End .product-action-vertical -->
  


                                                <%
                                                let price = i?.price; // Initialize price with default value

                                                if ((i?.subcategory_id?.offer && i?.subcategory_id?.offer?.status) || (i?.offer && i?.offer?.status)) {
                                                    let categoryOfferPrice = undefined; // Initialize with undefined
                                                    let productOfferPrice = undefined; // Initialize with undefined
                                                
                                                    if (i?.subcategory_id?.offer && i?.subcategory_id?.offer?.status) {
                                                        categoryOfferPrice = i?.price - (i?.price * i?.subcategory_id?.offer?.percentage / 100);
                                                    }
                                                
                                                    if (i?.offer && i?.offer?.status) {
                                                        productOfferPrice = i?.price - (i?.price * i?.offer?.percentage / 100);
                                                    }
                                                
                                                    // Check if either offer price is defined
                                                    if (categoryOfferPrice !== undefined || productOfferPrice !== undefined) {
                                                        // Handle the case where either offer price is undefined
                                                        if (categoryOfferPrice === undefined) {
                                                            price = productOfferPrice;
                                                        } else if (productOfferPrice === undefined) {
                                                            price = categoryOfferPrice;
                                                        } else {
                                                            // Both offer prices are defined, choose the lower one
                                                            price = Math.min(categoryOfferPrice, productOfferPrice);
                                                        }
                                                    }
                                                }
                                                %>
                                               
                                                <div class="product-action">
                                                    <% if (i?.quantity <=0) {%>
                                                        <a href="" class="btn-product btn-cart addToCartBtn" onclick="outOfStock()" ><span>OUT OF STOCK</span></a>
                                                           <% } else {%> 
                                                            <% if (isLoggedIn) { %>
                                                            <a href="#" class="btn-product btn-cart addToCartBtn" product-price="<%=i?.price %>" offer-price="<%= price %>" data-product-id="<%= i?._id %>"><span>add to cart</span></a>
                                                                <% } else { %>
                                                                    <a href="/login" class="btn-product btn-cart " ><span>add to cart</span></a>
                                                                    <% } %>
                                                            <% } %>                                                
                                                        </div><!-- End .product-action -->
                                            </figure><!-- End .product-media -->

                                            <div class="product-body">
                                                <div class="product-cat">
                                                    <a href=""><%=i?.subcategory_id?.name %></a>
                                                    <br>
                                                    <a href=""><%=i?.subcategory_id?.subcategory %></a>
                                                </div><!-- End .product-cat -->
                                                <h3 class="product-title"><a href=""><%=i?.name %></a></h3><!-- End .product-title -->

                                               
                                                
                                                <% if (price !== undefined) { %>
                                                    <div class="product-price">
                                                        <% if (i?.subcategory_id?.offer && i?.subcategory_id?.offer?.status) { %>
                                                            <del> ₹ <%= i?.price %></del> <!-- Striked original price -->
                                                            &nbsp; <!-- Space between original and offer price -->
                                                        <% } else if (i?.offer && i?.offer?.status) { %>
                                                            <del> ₹ <%= i?.price %></del> <!-- Striked original price -->
                                                            &nbsp; <!-- Space between original and offer price -->
                                                        <% } %>
                                                        ₹ <%= price %> <!-- Offer price -->
                                                    </div>
                                                <% } else { %>
                                                    <div class="product-price">
                                                        ₹ <%= i?.price %>
                                                    </div>
                                                <% } %>


                                                
                                                
                                                <div class="ratings-container">
                                                    <div class="ratings">
                                                        <div class="ratings-val" style="width: 20%;"></div><!-- End .ratings-val -->
                                                    </div><!-- End .ratings -->
                                                    <span class="ratings-text">( 2 Reviews )</span>
                                                </div><!-- End .rating-container -->

                                                <div class="product-nav product-nav-thumbs">
                                                    <a href="#" class="active">
                                                        <img src="/uploads/<%= i?.product_image[2]?.resizedFile %>" alt="product desc">
                                                    </a>
                                                    <a href="#">
                                                        <img src="/uploads/<%= i?.product_image[1]?.resizedFile %>" alt="product desc">
                                                    </a>

                                                    <a href="#">
                                                        <img src="/uploads/<%= i?.product_image[0]?.resizedFile %>" alt="product desc">
                                                    </a>
                                                </div><!-- End .product-nav -->
                                            </div><!-- End .product-body -->
                                        </div><!-- End .product -->
                                    </div><!-- End .col-sm-6 col-lg-4 -->

                                    <% }) %>
                                </div><!-- End .row -->
                            </div><!-- End .products -->



                            <!-- Pagination -->
                            <nav aria-label="Page navigation">
                                <ul class="pagination justify-content-center">
                                    <li class="page-item <%= currentPage === 1 ? 'disabled' : '' %>">
                                        <a class="page-link page-link-prev clicked-page"  onclick="applyFilter()" data-value="<%= currentPage - 1 %>" href= " " aria-label="Previous" tabindex="-1" aria-disabled="<%= currentPage === 1 %>">
                                            <span aria-hidden="true"><i class="icon-long-arrow-left"></i></span>Prev
                                        </a>
                                    </li>
                                    <% for (let i = 1; i <= totalPages; i++) { %>
                                        <li class="page-item <%= currentPage === i ? 'active' : '' %>">
                                            <a class="page-link clicked-page"  onclick="applyFilter()"  data-value ="<%= i %>"   href=""><%= i %></a>
                                        </li>
                                    <% } %>
                                    <li class="page-item-total">of <%= totalPages %></li>
                                    <li class="page-item <%= currentPage === totalPages ? 'disabled' : '' %>">
                                        <a class="page-link page-link-next clicked-page"  onclick="applyFilter()" data-value ="<%= currentPage + 1 %>" href="" aria-label="Next">
                                            Next <span aria-hidden="true"><i class="icon-long-arrow-right"></i></span>
                                        </a>
                                    </li>
                                </ul>
                            </nav>
                            
                            
  
                			<!-- <nav aria-label="Page navigation">
							    <ul class="pagination justify-content-center">
							        <li class="page-item disabled">
							            <a class="page-link page-link-prev" href="#" aria-label="Previous" tabindex="-1" aria-disabled="true">
							                <span aria-hidden="true"><i class="icon-long-arrow-left"></i></span>Prev
							            </a>
							        </li>
							        <li class="page-item active" aria-current="page"><a class="page-link" href="#">1</a></li>
							        <li class="page-item"><a class="page-link" href="#">2</a></li>
							        <li class="page-item"><a class="page-link" href="#">3</a></li>
							        <li class="page-item-total">of 6</li>
							        <li class="page-item">
							            <a class="page-link page-link-next" href="#" aria-label="Next">
							                Next <span aria-hidden="true"><i class="icon-long-arrow-right"></i></span>
							            </a>
							        </li>
							    </ul>
							</nav> -->
                		</div><!-- End .col-lg-9 -->
                		<aside class="col-lg-3 order-lg-first">
                			<div class="sidebar sidebar-shop">
                				<div class="widget widget-clean">
                					<label>Filters:</label>
                					<a href="#" class="sidebar-filter-clear" onclick="clearFilter()">Clean All</a>
                				</div>

                				<div class="widget widget-collapsible">
    								<h3 class="widget-title">
									    <a data-toggle="collapse" href="#widget-1" role="button" aria-expanded="true" aria-controls="widget-1">
									        Category
									    </a>
									</h3><!-- End .widget-title -->

									<div class="collapse show" id="widget-1">
										<div class="widget-body">
											<div class="filter-items filter-items-count">
                                                <% subcategory?.forEach((cateogy)=>{ %>
                                                    <div class="filter-item">
                                                        <div class="custom-control custom-checkbox">
                                                            <input type="checkbox" class="custom-control-input  filter-category" id="sub<%=cateogy %>" value="<%=cateogy %>">
                                                            <label class="custom-control-label" for="sub<%=cateogy %>"><%=cateogy %></label>
                                                        </div><!-- End .custom-checkbox -->
                                                    </div><!-- End .filter-item -->
                                                <% }) %>
	
											</div><!-- End .filter-items -->
										</div><!-- End .widget-body -->
									</div><!-- End .collapse -->
        						</div><!-- End .widget -->

        						

        						

        						<div class="widget widget-collapsible">
    								<h3 class="widget-title">
									    <a data-toggle="collapse" href="#widget-4" role="button" aria-expanded="true" aria-controls="widget-4">
									        Brand
									    </a>
									</h3><!-- End .widget-title -->

									<div class="collapse show" id="widget-4">
										<div class="widget-body">
											<div class="filter-items">
                                                <% brand?.forEach((brand)=>{ %>
                                                    <div class="filter-item">
                                                        <div class="custom-control custom-checkbox">
                                                            <input type="checkbox" class="custom-control-input filter-brand" id="brand<%=brand %>" value="<%=brand %>">
                                                            <label class="custom-control-label" for="brand<%=brand %>"><%=brand %></label>
                                                        </div><!-- End .custom-checkbox -->
                                                    </div><!-- End .filter-item -->
                                               <% }) %>
											</div><!-- End .filter-items -->
										</div><!-- End .widget-body -->
									</div><!-- End .collapse -->
        						</div><!-- End .widget -->

        						
                                <div>
                                    <button id="apply-filter" onclick="applyFilter()">Apply filter</button>
                                </div>
                			</div><!-- End .sidebar sidebar-shop -->
                		</aside><!-- End .col-lg-3 -->
                	</div><!-- End .row -->
                </div><!-- End .container -->
            </div><!-- End .page-content -->
        </main><!-- End .main -->

        <footer class="footer">
        	<div class="footer-middle">
	            <div class="container">
	            	<div class="row">
	            		<div class="col-sm-6 col-lg-3">
	            			<div class="widget widget-about">
	            				<img src="assets/images/logo.png" class="footer-logo" alt="Footer Logo" width="105" height="25">
	            				<p>Praesent dapibus, neque id cursus ucibus, tortor neque egestas augue, eu vulputate magna eros eu erat. </p>

	            				<div class="social-icons">
	            					<a href="#" class="social-icon" target="_blank" title="Facebook"><i class="icon-facebook-f"></i></a>
	            					<a href="#" class="social-icon" target="_blank" title="Twitter"><i class="icon-twitter"></i></a>
	            					<a href="#" class="social-icon" target="_blank" title="Instagram"><i class="icon-instagram"></i></a>
	            					<a href="#" class="social-icon" target="_blank" title="Youtube"><i class="icon-youtube"></i></a>
	            					<a href="#" class="social-icon" target="_blank" title="Pinterest"><i class="icon-pinterest"></i></a>
	            				</div><!-- End .soial-icons -->
	            			</div><!-- End .widget about-widget -->
	            		</div><!-- End .col-sm-6 col-lg-3 -->

	            		<div class="col-sm-6 col-lg-3">
	            			<div class="widget">
	            				<h4 class="widget-title">Useful Links</h4><!-- End .widget-title -->

	            				<ul class="widget-list">
	            					<li><a href="about.html">About Molla</a></li>
	            					<li><a href="#">How to shop on Molla</a></li>
	            					<li><a href="#">FAQ</a></li>
	            					<li><a href="contact.html">Contact us</a></li>
	            					<li><a href="login.html">Log in</a></li>
	            				</ul><!-- End .widget-list -->
	            			</div><!-- End .widget -->
	            		</div><!-- End .col-sm-6 col-lg-3 -->

	            		<div class="col-sm-6 col-lg-3">
	            			<div class="widget">
	            				<h4 class="widget-title">Customer Service</h4><!-- End .widget-title -->

	            				<ul class="widget-list">
	            					<li><a href="#">Payment Methods</a></li>
	            					<li><a href="#">Money-back guarantee!</a></li>
	            					<li><a href="#">Returns</a></li>
	            					<li><a href="#">Shipping</a></li>
	            					<li><a href="#">Terms and conditions</a></li>
	            					<li><a href="#">Privacy Policy</a></li>
	            				</ul><!-- End .widget-list -->
	            			</div><!-- End .widget -->
	            		</div><!-- End .col-sm-6 col-lg-3 -->

	            		<div class="col-sm-6 col-lg-3">
	            			<div class="widget">
	            				<h4 class="widget-title">My Account</h4><!-- End .widget-title -->

	            				<ul class="widget-list">
	            					<li><a href="#">Sign In</a></li>
	            					<li><a href="cart.html">View Cart</a></li>
	            					<li><a href="#">My Wishlist</a></li>
	            					<li><a href="#">Track My Order</a></li>
	            					<li><a href="#">Help</a></li>
	            				</ul><!-- End .widget-list -->
	            			</div><!-- End .widget -->
	            		</div><!-- End .col-sm-6 col-lg-3 -->
	            	</div><!-- End .row -->
	            </div><!-- End .container -->
	        </div><!-- End .footer-middle -->

	        <div class="footer-bottom">
	        	<div class="container">
	        		<p class="footer-copyright">Copyright © 2019 Molla Store. All Rights Reserved.</p><!-- End .footer-copyright -->
	        		<figure class="footer-payments">
	        			<img src="assets/images/payments.png" alt="Payment methods" width="272" height="20">
	        		</figure><!-- End .footer-payments -->
	        	</div><!-- End .container -->
	        </div><!-- End .footer-bottom -->
        </footer><!-- End .footer -->
    </div><!-- End .page-wrapper -->
    <button id="scroll-top" title="Back to Top"><i class="icon-arrow-up"></i></button>

    <!-- Mobile Menu -->
    <div class="mobile-menu-overlay"></div><!-- End .mobil-menu-overlay -->

    <div class="mobile-menu-container">
        <div class="mobile-menu-wrapper">
            <span class="mobile-menu-close"><i class="icon-close"></i></span>

            <form action="#" method="get" class="mobile-search">
                <label for="mobile-search" class="sr-only">Search</label>
                <input type="search" class="form-control" name="mobile-search" id="mobile-search" placeholder="Search in..." required>
                <button class="btn btn-primary" type="submit"><i class="icon-search"></i></button>
            </form>
            
            <nav class="mobile-nav">
                <ul class="mobile-menu">
                    <li>
                        <a href="/" class="">HOME</a>       
                    </li>
                    <li>
                        <a href="men" class="">MEN</a>                                  
                    </li>
                    <li>
                        <a href="women" class="">WOMEN</a>                                   
                    </li>
                    <li>
                        <a href="kids" class="">KIDS</a>                                    
                    </li>
                    <li>
                        <a href="/products" class="">ALL PRODUCTS</a>   
                    </li>
                </ul>
            </nav><!-- End .mobile-nav -->

            <div class="social-icons">
                <a href="#" class="social-icon" target="_blank" title="Facebook"><i class="icon-facebook-f"></i></a>
                <a href="#" class="social-icon" target="_blank" title="Twitter"><i class="icon-twitter"></i></a>
                <a href="#" class="social-icon" target="_blank" title="Instagram"><i class="icon-instagram"></i></a>
                <a href="#" class="social-icon" target="_blank" title="Youtube"><i class="icon-youtube"></i></a>
            </div><!-- End .social-icons -->
        </div><!-- End .mobile-menu-wrapper -->
    </div><!-- End .mobile-menu-container -->

    <!-- Sign in / Register Modal -->
    <div class="modal fade" id="signin-modal" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-body">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true"><i class="icon-close"></i></span>
                    </button>

                    <div class="form-box">
                        <div class="form-tab">
                            <ul class="nav nav-pills nav-fill" role="tablist">
                                <li class="nav-item">
                                    <a class="nav-link active" id="signin-tab" data-toggle="tab" href="#signin" role="tab" aria-controls="signin" aria-selected="true">Sign In</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="register-tab" data-toggle="tab" href="#register" role="tab" aria-controls="register" aria-selected="false">Register</a>
                                </li>
                            </ul>
                            <div class="tab-content" id="tab-content-5">
                                <div class="tab-pane fade show active" id="signin" role="tabpanel" aria-labelledby="signin-tab">
                                    <form action="#">
                                        <div class="form-group">
                                            <label for="singin-email">Username or email address *</label>
                                            <input type="text" class="form-control" id="singin-email" name="singin-email" required>
                                        </div><!-- End .form-group -->

                                        <div class="form-group">
                                            <label for="singin-password">Password *</label>
                                            <input type="password" class="form-control" id="singin-password" name="singin-password" required>
                                        </div><!-- End .form-group -->

                                        <div class="form-footer">
                                            <button type="submit" class="btn btn-outline-primary-2">
                                                <span>LOG IN</span>
                                                <i class="icon-long-arrow-right"></i>
                                            </button>

                                            <div class="custom-control custom-checkbox">
                                                <input type="checkbox" class="custom-control-input" id="signin-remember">
                                                <label class="custom-control-label" for="signin-remember">Remember Me</label>
                                            </div><!-- End .custom-checkbox -->

                                            <a href="#" class="forgot-link">Forgot Your Password?</a>
                                        </div><!-- End .form-footer -->
                                    </form>
                                    <div class="form-choice">
                                        <p class="text-center">or sign in with</p>
                                        <div class="row">
                                            <div class="col-sm-6">
                                                <a href="#" class="btn btn-login btn-g">
                                                    <i class="icon-google"></i>
                                                    Login With Google
                                                </a>
                                            </div><!-- End .col-6 -->
                                            <div class="col-sm-6">
                                                <a href="#" class="btn btn-login btn-f">
                                                    <i class="icon-facebook-f"></i>
                                                    Login With Facebook
                                                </a>
                                            </div><!-- End .col-6 -->
                                        </div><!-- End .row -->
                                    </div><!-- End .form-choice -->
                                </div><!-- .End .tab-pane -->
                                <div class="tab-pane fade" id="register" role="tabpanel" aria-labelledby="register-tab">
                                    <form action="#">
                                        <div class="form-group">
                                            <label for="register-email">Your email address *</label>
                                            <input type="email" class="form-control" id="register-email" name="register-email" required>
                                        </div><!-- End .form-group -->

                                        <div class="form-group">
                                            <label for="register-password">Password *</label>
                                            <input type="password" class="form-control" id="register-password" name="register-password" required>
                                        </div><!-- End .form-group -->

                                        <div class="form-footer">
                                            <button type="submit" class="btn btn-outline-primary-2">
                                                <span>SIGN UP</span>
                                                <i class="icon-long-arrow-right"></i>
                                            </button>

                                            <div class="custom-control custom-checkbox">
                                                <input type="checkbox" class="custom-control-input" id="register-policy" required>
                                                <label class="custom-control-label" for="register-policy">I agree to the <a href="#">privacy policy</a> *</label>
                                            </div><!-- End .custom-checkbox -->
                                        </div><!-- End .form-footer -->
                                    </form>
                                    <div class="form-choice">
                                        <p class="text-center">or sign in with</p>
                                        <div class="row">
                                            <div class="col-sm-6">
                                                <a href="#" class="btn btn-login btn-g">
                                                    <i class="icon-google"></i>
                                                    Login With Google
                                                </a>
                                            </div><!-- End .col-6 -->
                                            <div class="col-sm-6">
                                                <a href="#" class="btn btn-login  btn-f">
                                                    <i class="icon-facebook-f"></i>
                                                    Login With Facebook
                                                </a>
                                            </div><!-- End .col-6 -->
                                        </div><!-- End .row -->
                                    </div><!-- End .form-choice -->
                                </div><!-- .End .tab-pane -->
                            </div><!-- End .tab-content -->
                        </div><!-- End .form-tab -->
                    </div><!-- End .form-box -->
                </div><!-- End .modal-body -->
            </div><!-- End .modal-content -->
        </div><!-- End .modal-dialog -->
    </div><!-- End .modal -->






    <script>

        document.querySelectorAll('.addToCartBtn').forEach(function(button) {
            button.addEventListener('click', function(event) {
                event.preventDefault();
                let productPrice = this.getAttribute('product-price'); // Get the product price
                const offerPrice = this.getAttribute('offer-price'); // Get the offer price if available
             
                if (!isNaN(offerPrice)) {
                    productPrice=offerPrice
                 } 
         
                const data = {
                    productId:this.getAttribute('data-product-id'),
                    productPrice: productPrice,
                }
                axios.post('/add-to-cart',data )
                    .then(function(response) {
    
                        if (response.data.success) {
                            console.log(response.data.message);
                            window.location.href = '/cart?productId=' + data.productId;

                        } else {
                            console.error(response.data.message);
                        }
                    })
                    .catch(function(error) {
                        console.error('Error adding item to cart:', error);
                    });
            });
        }); 
    
    
    
    
    function addToWishList(productId,event){
        event.preventDefault();
        const data = {
            productId:productId
        }
    
        axios.post("/wish-list",data)
            .then(response =>{
                console.log(response.data);
                var color;
                if(response.data.checkIsThereProductID){
                    color = "red"
                }else{
                    color = "grey"
                }
                var heartIcon = document.getElementById(`wish${productId}`);
                heartIcon.setAttribute("fill",color);
            })
            .catch(error =>{
                console.error(error);
            })
        
    }


//-----================ out of stock =====

    function outOfStock(){
        Swal.fire({
        title: 'Out of Stock',
        text: 'This item is currently out of stock.',
        icon: 'warning',
        confirmButtonText: 'OK',
      });
    }

//===============================



let queryParams = [];

function applyFilter() {
    const categoryFilters = Array.from(document.querySelectorAll('.filter-category:checked')).map(input => input.value);
    const brandFilters = Array.from(document.querySelectorAll('.filter-brand:checked')).map(input => input.value);
    const sortBy = document.getElementById('sortby').value;
  
    const searchQuery = document.getElementById('product-search').value.trim();

    if (categoryFilters.length > 0) {
        queryParams.push(`category=${categoryFilters.join('&category=')}`);
        sessionStorage.setItem('categoryFilters', JSON.stringify(categoryFilters));
    } else {
        sessionStorage.removeItem('categoryFilters');
    }

    if (brandFilters.length > 0) {
        queryParams.push(`brand=${brandFilters.join('&brand=')}`);
        sessionStorage.setItem('brandFilters', JSON.stringify(brandFilters));
    } else {
        sessionStorage.removeItem('brandFilters');
    }

    if (sortBy) {
        queryParams.push(`sortBy=${sortBy}`);
        sessionStorage.setItem('sortBy', sortBy);
    } else {
        sessionStorage.removeItem('sortBy');
    }

    if (searchQuery) {
        queryParams.push(`search=${searchQuery}`);
        sessionStorage.setItem('searchQuery', searchQuery);
    } else {
        sessionStorage.removeItem('searchQuery');
    }

    const queryString = queryParams.length > 0 ? '?' + queryParams.join('&') : '';
    const path = "<%= path %>"
    window.location.href = path + queryString;
}

// Function to apply filters on page load
function applyFiltersOnLoad() {
    const categoryFilters = JSON.parse(sessionStorage.getItem('categoryFilters')) || [];
    const brandFilters = JSON.parse(sessionStorage.getItem('brandFilters')) || [];
    const sortBy = sessionStorage.getItem('sortBy') || '';
    const searchQuery = sessionStorage.getItem('searchQuery') || '';

    // Apply category filters
    categoryFilters.forEach(value => {
        const checkbox = document.querySelector(`.filter-category[value="${value}"]`);
        if (checkbox) {
            checkbox.checked = true;
        }
    });

    // Apply brand filters
    brandFilters.forEach(value => {
        const checkbox = document.querySelector(`.filter-brand[value="${value}"]`);
        if (checkbox) {
            checkbox.checked = true;
        }
    });

    // Apply sort by
    if (sortBy) {
        document.getElementById('sortby').value = sortBy;
    }

    // Apply search query
    document.getElementById('product-search').value = searchQuery;

    // Clear the queryParams array to prevent duplicate entries
    queryParams = [];
}

// Call applyFiltersOnLoad when the page loads
window.onload = applyFiltersOnLoad;

document.addEventListener('DOMContentLoaded', function() {
    const paginationLinks = document.querySelectorAll('.clicked-page');
    console.log("Pagination links found:", paginationLinks.length);
    
    paginationLinks.forEach(function(link) {
        link.addEventListener('click', function(event) {
            event.preventDefault();
            const currentPage = parseInt(this.getAttribute('data-value')); 
            if (!isNaN(currentPage)) {
                queryParams.push(`page=${currentPage}`);
                sessionStorage.setItem('currentPage', currentPage);
                const queryString = queryParams.length > 0 ? '?' + queryParams.join('&') : '';
                const path = "<%=path %>"
                window.location.href = path + queryString;
            } else {
                sessionStorage.removeItem('currentPage');
            }
        });
    });
});



function clearFilter(){
    sessionStorage.removeItem('categoryFilters');
    sessionStorage.removeItem('brandFilters');
    sessionStorage.removeItem('sortBy');
    sessionStorage.removeItem('searchQuery');
    const path = "<%=path %>"
    window.location.href = path
}



    </script>
        
        
     
    

 










    <!-- Plugins JS File -->
    <script src="assets/js/jquery.min.js"></script>
    <script src="assets/js/bootstrap.bundle.min.js"></script>
    <script src="assets/js/jquery.hoverIntent.min.js"></script>
    <script src="assets/js/jquery.waypoints.min.js"></script>
    <script src="assets/js/superfish.min.js"></script>
    <script src="assets/js/owl.carousel.min.js"></script>
    <script src="assets/js/wNumb.js"></script>
    <script src="assets/js/bootstrap-input-spinner.js"></script>
    <script src="assets/js/jquery.magnific-popup.min.js"></script>
    <script src="assets/js/nouislider.min.js"></script>
    <!-- Main JS File -->
    <script src="assets/js/main.js"></script>
</body>


<!-- molla/category.html  22 Nov 2019 10:02:52 GMT -->
</html>
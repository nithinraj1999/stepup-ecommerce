<%-include('../layout/adminHeader')-%>

    <div class="container-scroller">
      <!-- partial:../../partials/_sidebar.html -->
      <nav class="sidebar sidebar-offcanvas" id="sidebar">
        <div class="sidebar-brand-wrapper d-none d-lg-flex align-items-center justify-content-center fixed-top">
          <a class="sidebar-brand brand-logo" href="../../index.html"><img src="../../assets2/images/logo.svg" alt="logo" /></a>
          <a class="sidebar-brand brand-logo-mini" href="../../index.html"><img src="../../assets2/images/logo-mini.svg" alt="logo" /></a>
        </div>
        <ul class="nav">
          <li class="nav-item profile">
            <div class="profile-desc">
              <div class="profile-pic">
                <div class="count-indicator">
                  <img class="img-xs rounded-circle " src="../../assets2/images/faces/face15.jpg" alt="">
                  <span class="count bg-success"></span>
                </div>
                <div class="profile-name">
                  <h5 class="mb-0 font-weight-normal">Henry Klein</h5>
                  <span>Gold Member</span>
                </div>
              </div>
              <a href="#" id="profile-dropdown" data-toggle="dropdown"><i class="mdi mdi-dots-vertical"></i></a>
              <div class="dropdown-menu dropdown-menu-right sidebar-dropdown preview-list" aria-labelledby="profile-dropdown">
                <a href="#" class="dropdown-item preview-item">
                  <div class="preview-thumbnail">
                    <div class="preview-icon bg-dark rounded-circle">
                      <i class="mdi mdi-settings text-primary"></i>
                    </div>
                  </div>
                  <div class="preview-item-content">
                    <p class="preview-subject ellipsis mb-1 text-small">Account settings</p>
                  </div>
                </a>
                <div class="dropdown-divider"></div>
                <a href="#" class="dropdown-item preview-item">
                  <div class="preview-thumbnail">
                    <div class="preview-icon bg-dark rounded-circle">
                      <i class="mdi mdi-onepassword  text-info"></i>
                    </div>
                  </div>
                  <div class="preview-item-content">
                    <p class="preview-subject ellipsis mb-1 text-small">Change Password</p>
                  </div>
                </a>
                <div class="dropdown-divider"></div>
                <a href="#" class="dropdown-item preview-item">
                  <div class="preview-thumbnail">
                    <div class="preview-icon bg-dark rounded-circle">
                      <i class="mdi mdi-calendar-today text-success"></i>
                    </div>
                  </div>
                  <div class="preview-item-content">
                    <p class="preview-subject ellipsis mb-1 text-small">To-do list</p>
                  </div>
                </a>
              </div>
            </div>
          </li>
          <li class="nav-item nav-category">
            <span class="nav-link">Navigation</span>
          </li>
          <li class="nav-item menu-items">
            <a class="nav-link" href="/admin/dashboard">
              <span class="menu-icon">
                <i class="mdi mdi-speedometer"></i>
              </span>
              <span class="menu-title">Dashboard</span>
            </a>
          </li>
          <li class="nav-item menu-items">
            <a class="nav-link" href="/admin/user">
              <span class="menu-icon">
                <i class="mdi mdi-speedometer"></i>
              </span>
              <span class="menu-title">All User</span>
            </a>
          </li>
          <li class="nav-item menu-items">
            <a class="nav-link" href="/admin/all-products">
              <span class="menu-icon">
                <i class="mdi mdi-playlist-play"></i>
              </span>
              <span class="menu-title">All Products</span>
            </a>
          </li>
          <li class="nav-item menu-items">
            <a class="nav-link" href="/admin/addproduct">
              <span class="menu-icon">
                <i class="mdi mdi-table-large"></i>
              </span>
              <span class="menu-title">Add a new Products</span>
            </a>
          </li>
          <li class="nav-item menu-items">
            <a class="nav-link" href="/admin/category">
              <span class="menu-icon">
                <i class="mdi mdi-chart-bar"></i>
              </span>
              <span class="menu-title">Category</span>
            </a>
          </li>
          <li class="nav-item menu-items">
            <a class="nav-link" href="/admin/editcategory">
              <span class="menu-icon">
                <i class="mdi mdi-contacts"></i>
              </span>
              <span class="menu-title">Edit Category</span>
            </a>
          </li>
          <li class="nav-item menu-items">
            <a class="nav-link"  href="/admin/orders" >
              <span class="menu-icon">
                <i class="mdi mdi-security"></i>
              </span>
              <span class="menu-title">Orders</span>              
            </a>
          </li>
          <li class="nav-item menu-items">
            <a class="nav-link" href="/admin/coupens" >
              <span class="menu-icon">
                <i class="mdi mdi-security"></i>
              </span>
              <span class="menu-title">Coupens</span>              
            </a>
          </li>
          <li class="nav-item menu-items">
            <a class="nav-link"  href="/admin/offer" >
              <span class="menu-icon">
                <i class="mdi mdi-security"></i>
              </span>
              <span class="menu-title">Offer</span>              
            </a>
          </li>
          <li class="nav-item menu-items">
            <a class="nav-link" href="/admin/sales">
              <span class="menu-icon">
                <i class="mdi mdi-file-document-box"></i>
              </span>
              <span class="menu-title">Sales Report</span>
            </a>
          </li>
          <!-- <li class="nav-item menu-items">
            <a class="nav-link" href="">
              <span class="menu-icon">
                <i class="mdi mdi-file-document-box"></i>
              </span>
              <span class="menu-title">Banners</span>
            </a>
          </li> -->
        </ul>
      </nav>
      <!-- partial -->
      <div class="container-fluid page-body-wrapper">
        <!-- partial:../../partials/_navbar.html -->
        <nav class="navbar p-0 fixed-top d-flex flex-row">
          <div class="navbar-brand-wrapper d-flex d-lg-none align-items-center justify-content-center">
            <a class="navbar-brand brand-logo-mini" href="../../index.html"><img src="../../assets/images/logo-mini.svg" alt="logo" /></a>
          </div>
          <div class="navbar-menu-wrapper flex-grow d-flex align-items-stretch">
            <button class="navbar-toggler navbar-toggler align-self-center" type="button" data-toggle="minimize">
              <span class="mdi mdi-menu"></span>
            </button>
            <ul class="navbar-nav w-100">
              <li class="nav-item w-100">
                <form class="nav-link mt-2 mt-md-0 d-none d-lg-flex search">
                  <input type="text" class="form-control" placeholder="Search user">
                </form>
              </li>
            </ul>
            <ul class="navbar-nav navbar-nav-right">  
              <li>
                <a type="button" href="/admin/logout">Logout</a>
               </li>            
      
            </ul>
            <button class="navbar-toggler navbar-toggler-right d-lg-none align-self-center" type="button" data-toggle="offcanvas">
              <span class="mdi mdi-format-line-spacing"></span>
            </button>
          </div>
        </nav>
        <!-- partial -->
        <div class="main-panel">
          <div class="content-wrapper">
    
            <form method="post"  action="/admin/addproduct" enctype="multipart/form-data">
              <h1 class="category-text">Add Product</h1>
              <div class="mb-3">
                <div class="row g-3">
                  <div class="col">
                    <label for="exampleFormControlTextarea1" class="form-label">Product Name</label>
                    <input type="text" class="form-control" required name="name"  pattern="[A-Za-z]+( [A-Za-z]+)*"  aria-label="First name">
                  </div>
                  <div class="col">
                    <label for="exampleFormControlTextarea1" class="form-label">Product Manufacturer</label>
                    <input type="text" class="form-control" required  name="manufacturer"pattern="[A-Za-z]+( [A-Za-z]+)*" aria-label="Last name">
                  </div>
                  <div class="col">
                    <label for="exampleFormControlTextarea1" class="form-label">Product Price</label>
                    <input type="text" class="form-control"required name="price" pattern="[0-9]+" aria-label="Last name">
                  </div>
                </div>
              </div>
              <div class="mb-3">
                <label for="exampleFormControlTextarea1" class="form-label">Product description</label>
                <textarea class="form-control"required pattern="^\S.*$" name="description" id="exampleFormControlTextarea1" rows="3"></textarea>
              </div>
              <div class="mb-3" style="display: flex;">
                
                <div style="margin-right: 10px;">
                    <label for="main-category1" class="category-text">Main Category </label>
                    <select class="form-select" name="maincategory" style="width: 250px;" aria-label="Default select example"  onchange="getSubcategories(this.value)">
                      <option value="" disabled selected>Choose Category</option>
                        <option value="Men">Men</option>
                        <option value="Women">Women</option>
                        <option value="Kids">Kids</option>
                    </select>
                </div>
                <div style="margin-right: 10px;">
                  <label for="sub-category" class="category-text">Sub Category </label>
                  <select class="form-select" name="subcategory" style="width: 250px;" aria-label="Default select example" id="subcategoryDropdown">
                     
                  </select>
              </div>
              
               
                  <div class="col">
                      <label for="quantity">Quantity:</label>
                      <input type="number" required class="form-control w-25" id="quantity" name="quantity" min="0"  value="1">
                  </div>
                 

            </div>

            <style>
              .image-preview {
        display: flex;
        flex-wrap: wrap;
    }
    .image-preview img {
        max-width: 200px;
        max-height: 200px;
        margin: 5px;
    }
    .remove-button {
        background-color: red;
        color: white;
        border: none;
        padding: 5px 10px;
        cursor: pointer;
    }
          </style>
            
            <div class="row g-3">
              <div class="col">
                <label for="exampleFormControlTextarea1" class="form-label">Choose images :</label>
                <input type="file" required name="avatar" multiple onchange="displaySelectedImages(event)">
            </div>
              <div class="image-preview" id="imagePreview">
                <!-- Selected images will be displayed here -->
            </div>

              <div class="mb-3">
                <button class="btn btn-primary" type="submit">Add Product</button>
              </div>
            </form>
            </div>               
             
            
          </div>
          
          <!-- content-wrapper ends -->
          <!-- partial:../../partials/_footer.html -->
          <!-- partial -->
        </div>
        <!-- main-panel ends -->
      </div>
      <!-- page-body-wrapper ends -->
    </div>
    <!-- container-scroller -->
    <!-- plugins:js -->


    <script>

      function getSubcategories(mainCategory){
        axios.get(`/admin/load-subcategories?mainCategory=${mainCategory}`)
        .then(response =>{
          console.log(response.data.subcategory);
          const subcategoryDropdown = document.getElementById('subcategoryDropdown');
                subcategoryDropdown.innerHTML = '';


                response.data.subcategory.forEach(function (subcategory) {
                    const option = document.createElement('option');
                    option.value = subcategory;
                    option.text = subcategory;
                    subcategoryDropdown.add(option);
                });
          
        })
        .catch(error=>{
          console.log(error);
        })
      }

      function displaySelectedImages(event) {
        var preview = document.getElementById('imagePreview');
        preview.innerHTML = ''; // Clear previous preview

        var files = event.target.files;

        for (var i = 0; i < files.length; i++) {
            var file = files[i];
            var reader = new FileReader();

            reader.onload = function (e) {
                var img = document.createElement('img');
                img.src = e.target.result;
                img.className = 'preview-image';

                var deleteButton = document.createElement('button');
                deleteButton.textContent = 'Delete';
                deleteButton.className = 'delete-button';
                deleteButton.onclick = function () {
                    this.parentNode.remove(); // Remove the image preview when the delete button is clicked
                };

                var container = document.createElement('div');
                container.className = 'image-container';
                container.appendChild(img);
                container.appendChild(deleteButton);

                preview.appendChild(container);
            };

            reader.readAsDataURL(file);
        }
    }
    </script>





<%-include('../layout/adminFooter')-%>
